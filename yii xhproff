XHprof и Yii
Устанавливал XHprof на Ubuntu 12.04, сервер Apache, для Yii 1.х и не нашел прозрачной для себя документации, как это сделать. В итоге, с миру по нитке…

1. Установка самого расширения XHprof для PHP и Graphviz для вывода схем.

sudo add-apt-repository ppa:brianmercer/php5-xhprof
sudo apt-get update
sudo apt-get install php5-xhprof
sudo apt-get install graphviz
sudo /etc/init.d/apache2 restart
Настройки XHprof лежат в /etc/php5/conf.d/xhprof.ini, по-умолчанию такие:

extension=xhprof.so
xhprof.output_dir=/tmp
2. Далее, чтобы запустить его на своем сайте, заходим на страницу XHprof и качаем сорцы. На сегодня — это версия 0.9.4.

3. Создаем в корне сайта директорию для этой тулзы, например tools.

4. В эту директорию распаковываем папки xhprof_html и xhprof_lib из скачанного архива.

5. Дополнительно в директории xhprof_html создаем два файла:

header.php

<?php
if (extension_loaded('xhprof')) {
    $utils_path = dirname(__FILE__) . "/../xhprof_lib/utils/";
    include_once $utils_path.'xhprof_lib.php';
    include_once $utils_path.'xhprof_runs.php';
    xhprof_enable(XHPROF_FLAGS_CPU + XHPROF_FLAGS_MEMORY);
}
footer.php

<?php
if (extension_loaded('xhprof')) {
    $profiler_namespace = 'lsp';
    $xhprof_data = xhprof_disable();
    $xhprof_runs = new XHProfRuns_Default();
    $run_id = $xhprof_runs->save_run($xhprof_data, $profiler_namespace);
    $profiler_url = sprintf('http://' . $_SERVER['SERVER_NAME'] . '/tools/xhprof_html/index.php?run=%s&source=%s', $run_id, $profiler_namespace);
    echo '<a href="'.$profiler_url.'">XHProf</a>';
}
6. Последний шаг — подключаем это все добро к нашим страницам. Я сделал это в index.php:

<?php
 
$config=dirname(__FILE__).'/protected/config/main.php';
 
if ($_SERVER['HTTP_HOST'] == 'lsp.local') {
    include(dirname(__FILE__).'/tools/xhprof_html/header.php');
    require_once(dirname(__FILE__).'/protected/c3.php');
    $yii=dirname(__FILE__).'/framework/yii.php';
    // remove the following lines when in production mode
    defined('YII_DEBUG') or define('YII_DEBUG',true);
    // specify how many levels of call stack should be shown in each log message
    defined('YII_TRACE_LEVEL') or define('YII_TRACE_LEVEL',3);
} else {
    $yii=dirname(__FILE__).'/framework/yiilite.php';
}
 
$global = dirname(__FILE__).'/protected/helpers/Global.php';
 
require_once($yii);
require_once($global);
 
Yii::createWebApplication($config)->run();
 
if ($_SERVER['HTTP_HOST'] == 'lsp.local') {
    include(dirname(__FILE__).'/tools/xhprof_html/footer.php');
}
Подключаю только для локальной копии сайта.

В итоге, имеем ссылку XHProf внизу каждой страницы сайта.
